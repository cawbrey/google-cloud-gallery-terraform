#!/bin/bash

# Base64 encoded tarball begins here
tarball="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"

# Decode the tarball and extract it
mkdir gallery
echo "Restoring files to the 'gallery' directory..."
echo "$tarball" | base64 --decode | tar -xz -C gallery

echo "Files have been restored inside the 'gallery' directory."

# Update package list and install dependencies
sudo apt-get update
sudo apt-get install -yq python3-pip python3-venv


# Run the flask app under a venv
cd gallery
python3 -m venv gallery_venv
source gallery_venv/bin/activate
pip install --upgrade pip
pip install -r ./requirements.txt
export FLASK_APP="main.py"
export FLASK_RUN_PORT="80"
export FLASK_RUN_HOST="0.0.0.0"
flask run
